CREATE TABLE Employees(
employee_name char[30],
employee_id int PRIMARY KEY,
employee_salary int
);

INSERT INTO Employees
VALUES ("Amisha", 1, 100);

INSERT INTO Employees
VALUES ("Manisha", 2, 140);

INSERT INTO Employees
VALUES ("Tanuj", 3, 200);

INSERT INTO Employees
VALUES ("Kapil", 4, 50);

INSERT INTO Employees
VALUES ("Akasa", 5, 109);

INSERT INTO Employees
VALUES ("Akshay", 6, 40);

SELECT MIN(employee_salary)
FROM (SELECT employee_salary FROM Employees
ORDER BY employee_salary DESC
LIMIT(5)) ;

-----------------------------
CREATE TABLE Employees(
employee_name char[30],
employee_id int PRIMARY KEY,
employee_salary int
);

INSERT INTO Employees
VALUES ("Amisha", 1, 100);

INSERT INTO Employees
VALUES ("Manisha", 2, 140);

INSERT INTO Employees
VALUES ("Tanuj", 3, 200);

INSERT INTO Employees
VALUES ("Kapil", 4, 50);

INSERT INTO Employees
VALUES ("Akasa", 5, 109);

INSERT INTO Employees
VALUES ("Akshay", 6, 40);

CREATE TABLE Organizations(
organization int PRIMARY KEY,
organization_id int,
organization_name char[50],
employee_id int
);

INSERT INTO Organizations
VALUES(1, 1, "TCS", 1);

INSERT INTO Organizations
VALUES(2, 2,  "TPS", 2);

INSERT INTO Organizations
VALUES(3, 2, "TKS", 3);

INSERT INTO Organizations
VALUES(4, 3, "TM", 4);

INSERT INTO Organizations
VALUES(5, 2, "TW", 5);

INSERT INTO Organizations
VALUES(6, 4, "Xteria", 6);

Select sum(a.employee_salary) from Employees as a
join Organizations as b on a.employee_id = b.employee_id
where b.organization_id = 2;

----------------------------------
//update the organizations table structure and create a new table for parent - child relation
CREATE TABLE Employees(
employee_name char[30],
employee_id int PRIMARY KEY,
employee_salary int
);

INSERT INTO Employees
VALUES ("Amisha", 1, 100);

INSERT INTO Employees
VALUES ("Manisha", 2, 140);

INSERT INTO Employees
VALUES ("Tanuj", 3, 200);

INSERT INTO Employees
VALUES ("Kapil", 4, 50);

INSERT INTO Employees
VALUES ("Akasa", 5, 109);

INSERT INTO Employees
VALUES ("Akshay", 6, 40);

CREATE TABLE Organizations(
organization int PRIMARY KEY,
organization_id int,
organization_name char[50],
employee_id int
);

INSERT INTO Organizations
VALUES(1, 1, "TCS", 1);

INSERT INTO Organizations
VALUES(2, 2,  "TPS", 2);

INSERT INTO Organizations
VALUES(3, 2, "TKS", 3);

INSERT INTO Organizations
VALUES(4, 3, "TM", 4);

INSERT INTO Organizations
VALUES(5, 2, "TW", 5);

INSERT INTO Organizations
VALUES(6, 4, "Xteria", 6);

CREATE TABLE ParentOrganizations(
parent_organization_id int PRIMARY KEY,
parent_organization_name char[50]
);

INSERT INTO ParentOrganizations
VALUES(1, "Parent 1");

INSERT INTO ParentOrganizations
VALUES(2,"Parent 2");

SELECT o.organization_id, count(*)
FROM Organizations as o JOIN OrganizationsHierarchy as oh
ON o.organization_id = oh.organization_id
group by o.organization_id
having oh.organization_id IN (Select organization_id from OrganizationsHierarchy where parent_organization_id = 1);
